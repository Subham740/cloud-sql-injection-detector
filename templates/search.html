{% extends "base.html" %}
{% block content %}
<h2>Search Users (SQLi Detection Demo)</h2>
<form method="post" class="mt-3">
    <div class="mb-3">
        <label class="form-label">Search term (name)</label>
        <input class="form-control" type="text" name="term" required>
    </div>
    <button class="btn btn-success" type="submit">Search</button>
</form>

{% if built_query %}
<div class="mt-4">
    <h5>Constructed (vulnerable) query for demonstration:</h5>
    <code>{{ built_query }}</code>
</div>
{% endif %}

{% if message %}
<div class="alert alert-warning mt-3">
    {{ message }}
</div>
{% endif %}

{% if results %}
<div class="mt-4">
    <h5>Results:</h5>
    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>ID</th><th>Name</th><th>Email</th>
            </tr>
        </thead>
        <tbody>
            {% for r in results %}
            <tr>
                <td>{{ r['id'] }}</td>
                <td>{{ r['name'] }}</td>
                <td>{{ r['email'] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}
{% endblock %}
